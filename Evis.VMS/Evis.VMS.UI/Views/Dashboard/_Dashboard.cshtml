
<script src="~/Content/Scripts/plugins/Chart.min.js"></script>
<script src="~/Content/Scripts/plugins/curvedLines.js"></script>
<script src="~/Content/Scripts/plugins/jquery.flot.js"></script>
<script src="~/Content/Scripts/plugins/jquery.flot.time.js"></script>
<div class="row top_tiles">
    <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
        <div class="tile-stats box1">
            <a href="javascript:void(0)" id="lnkVisitorCheckIn">
                <div class="icon" style="color: #22A7F0"><i class="fa fa-user-plus fa-1"></i></div>
                <div class="count">3</div>
                <h3>Checked-In visitors</h3>
                <p>checked-In visitors</p>
            </a>
        </div>
    </div>
    <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
        <div class="tile-stats box2">
            <a href="javascript:void(0)" id="lnkTotalVisitor">
                <div class="icon" style="color: #FABE28"><i class="fa fa-users fa-1"></i></div>
                <div class="count">14</div>
                <h3>Visitors</h3>
                <p>Total visitors current day</p>
            </a>
        </div>
    </div>
    <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
        <div class="tile-stats box3">
            <a href="javascript:void(0)" id="lnkBuilding">
                <div class="icon" style="color: #1ABC9C"><i class="fa fa-building-o"></i></div>
                <div class="count">3</div>
                <h3>Building</h3>
                <p>Total bulding</p>
            </a>
        </div>
    </div>
    <div class="animated flipInY col-lg-3 col-md-3 col-sm-6 col-xs-12">
        <div class="tile-stats box4">
            <a href="javascript:void(0)" id="lnkGates">
                <div class="icon" style="color: #fb927d"><i class="fa fa-outdent"></i></div>
                <div class="count">12</div>
                <h3>Gates</h3>
                <p>Total gates</p>
            </a>
        </div>
    </div>

</div>
<div class="row">
    <div class="col-md-12 col-sm-12 col-xs-12">
        <div class="dashboard_graph x_panel">
            <div class="row x_title">
                <div class="col-md-6">
                    <h3>Visitor Count <small>Graph </small></h3>
                </div>

            </div>
            <div class="x_content">
                <div class="demo-container" style="height:250px">
                    <div id="placeholder3xx3" class="demo-placeholder" style="width: 100%; height: 250px; padding: 0px; position: relative;">
                       <div class="legend">
                            <div style="position: absolute; width: 76px; height: 15px; top: 13px; right: 13px; opacity: 0.85; background-color: rgb(255, 255, 255);"> </div>
                            <table style="position:absolute;top:13px;right:13px;font-size:smaller;color:#545454">
                                <tbody>
                                    <tr>
                                        <td class="legendColorBox">
                                            <div style="border:1px solid #ccc;padding:1px">
                                                <div style="width:4px;height:0;border:5px solid rgb(38,185,154);overflow:hidden"></div>
                                            </div>
                                        </td>
                                        @*<td class="legendLabel">Registrations</td>*@
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-lg-12">
        <div class="dashboard_graph x_panel">
            <div class="x_title">
                <h2>Daily Shift Details</h2>
                <div class="clearfix"></div>
            </div>

            <table class="table jambo_table">
                <thead>
                    <tr>
                        <th style="width: 5%">#</th>
                        <th style="width: 25%"> <a href="#" onclick="DataGrid.Sort('UserName')" class="sortCol">Security Name</a> </th>
                        <th style="width: 20%"> <a href="#" onclick="DataGrid.Sort('BuildingName')" class="sortCol">Building Name</a></th>
                        <th style="width: 25%"><a href="#" onclick="DataGrid.Sort('GateName')" class="sortCol">Gate Name</a></th>
                        <th style="width: 25%"><a href="#" onclick="DataGrid.Sort('ShiftName')" class="sortCol">Shift Name</a></th>
                        
                    </tr>
                </thead>
                <tbody data-bind="foreach:DataGrid.DataRows">
                    <tr>
                        <td  scope="row" data-bind="text:$index() +1"></td>
                        <td  data-bind="text: UserName"></td>
                        <td data-bind="text:BuildingName" ></td>
                        <td data-bind="text:GateName" ></td>
                        <td data-bind="text:ShiftName" ></td>
                    </tr>
                </tbody>
                <tr class="blank_row" data-bind="visible: (DataGrid.DataRows().length == 0)"><td colspan="10">No data, Add new records.</td></tr>
            </table>
            @Html.Partial("_Pager")
        </div>


    </div>
</div>



<script>
    $(document).ready(function () {
        //random data
        var graphData;
        var fromDate = new Date();
        var toDate = new Date();
        var arr = [];
        // evt.preventDeafult();
        AjaxCall('../Api/DashBoard/LoadGraph', null, 'GET', function (data) {
            //   debugger;
            //$.each(data, function (inx, val) {
            //    var obj = [];
            //    obj[0] = val.Date;
            //    obj[1] = val.Count;
            //    // obj.label = val.label;
            //    arr.push(obj);
            //});
            graphData = data;
            var dataArray = new Array(graphData.length);
            for (var i = 0; i < graphData.length; i++) {
                var dataValue = new Array(2);
                dataValue[0] = gd(graphData[i].m_Item2);
                dataValue[1] = graphData[i].m_Item1;
                dataArray[i] = dataValue;
            }

            arr = dataArray;
            var dataset = [
           {
               label: "Visitors",
               data: arr,
               color: "#FF0000",
               points: { fillColor: "#FF0000", show: true },
               lines: { show: true }
           }

            ];
            var options = {
                series: {
                    curvedLines: {
                        apply: true,
                        active: true,
                        monotonicFit: true
                    }
                },
                xaxes: [
               {
                   mode: "time",
                   timeformat: "%m/%d",
                   tickSize: [1, "day"],
                   tickLength: 1,
                   color: "black",
                   axisLabel: "Date",
                   //  axisLabelUseCanvas: true,
                   axisLabelFontSizePixels: 12,
                   axisLabelFontFamily: 'Verdana, Arial',
                   axisLabelPadding: 0
               }],
                yaxis: {

                    tickDecimals: 0,
                    axisLabel: "",

                },
                colors: ["#26B99A"],
                legend: {
                    noColumns: 0,
                    labelBoxBorderColor: "#000000",
                    position: "nw"
                },
                grid: {
                    borderWidth: {
                        top: 0,
                        right: 1,
                        bottom: 1,
                        left: 1
                    },
                    borderColor: {
                        bottom: "#7F8790",
                        left: "#7F8790"
                    },
                    hoverable: true,
                    //  borderWidth: 3,
                    mouseActiveRadius: 50,
                    // backgroundColor: { colors: ["#ffffff", "#EDF5FF"] },
                    //  axisMargin: 20
                }
            };
            var plot = $.plot($("#placeholder3xx3"), dataset, options);
        });



        //for (var arrayIndex in graphData) {
        //    debugger;
        //    grph = "[" + arrayIndex[1] + "," + arrayIndex[0] + "],";
        //}
        // debugger;


        //flot options




        var dayOfWeek = ["Sun", "Mon", "Tue", "Wed", "Thr", "Fri", "Sat"];



        //  var plot = $.plot($("#placeholder3xx3"), dataset, options);

        function gd(date) {
            //alert(date);
            var arrDate = date.split('/');
            // userData.DOB = ([initial[1], initial[0], initial[2]].join('/'));
            return new Date(arrDate[2], arrDate[1] - 1, arrDate[0]).getTime();
        }

        //var plot = $.plot($("#placeholder3xx3"), [{
        //    label: "",
        //    data: d1,

        //    lines: {
        //        fillColor: "rgba(150, 202, 89, 0.12)"
        //    }, //#96CA59 rgba(150, 202, 89, 0.42)
        //    points: {
        //        fillColor: "#fff"
        //    }
        //}], options);
    });
</script>
@*<div class="row">

        <div class="col-md-8 col-xs-12">
            <canvas id="canvas"></canvas>
        </div>
        <div class="col-md-4 col-xs-12">
            <div id="map_canvas" style="height:400px;"></div>

            <h4 style=" text-align:center;">Bulding locations</h4>
        </div>
    </div>

    <br />
    <style type="text/css">
        .infoDiv {
            height: 80px;
            width: 150px;
            font-size: small;
            -webkit-user-select: none;
            background-color: white;
            color: black;
        }
    </style>

    <script>
        var config = {
            type: 'bar',
            fontColor: '#fff',
            data: {
                labels: ["12/06", "13/06", "14/06", "15/06", "16/06", "17/06", "18/06"],
                fontColor: '#fff',
                datasets: [{
                    label: "",
                    fontColor: '#fff',
                    data: [1, 10, 25, 40, 30, 14, 23],
                    fill: false,
                    backgroundColor:'#fff'
                }]
            },
            options: {
                responsive: true,
                font: '#fff',
                elements: { rectangle: { borderWidth: 2, borderColor:'#fff', borderSkipped: 'bottom' } },
                title: {
                    display: true,
                    fontColor: '#fff',
                    text: 'Visitors/Week',

                },
                legend: {
                    display: false,
                    labels: {
                        fontColor: 'rgb(255, 99, 132)'
                    }
                },
                tooltips: {
                    mode: 'label',
                    callbacks: {
                        // beforeTitle: function() {
                        //     return '...beforeTitle';
                        // },
                        // afterTitle: function() {
                        //     return '...afterTitle';
                        // },
                        // beforeBody: function() {
                        //     return '...beforeBody';
                        // },
                        // afterBody: function() {
                        //     return '...afterBody';
                        // },
                        // beforeFooter: function() {
                        //     return '...beforeFooter';
                        // },
                        // footer: function() {
                        //     return 'Footer';
                        // },
                        // afterFooter: function() {
                        //     return '...afterFooter';
                        // },
                    }
                },
                hover: {
                    mode: ''
                },
                scales: {
                    xAxes: [{
                        display: true,
                        fontColor: '#fff',
                        scaleLabel: {
                            display: true,
                            fontColor: '#fff',
                            labelString: 'Date'

                        }
                    }],
                    yAxes: [{
                        display: true,
                        scaleLabel: {
                            display: true,
                            labelString: 'No. of Visitors',
                            fontColor: '#fff'
                        },
                        ticks: {
                            suggestedMin: 0,
                            suggestedMax: 50
                        }
                    }]
                }

            }
        };



        $.each(config.data.datasets, function (i, dataset) {

            dataset.borderColor = 'rgba(255,255,255,1)';
            //alert(dataset.borderColor);
            dataset.backgroundColor = 'rgba(255,99,45,0.5)';
            dataset.pointBorderColor = 'rgba(255,255,255,0.7)';
            dataset.pointBackgroundColor = 'rgba(255,255,255,0.5)';
            dataset.pointBorderWidth = 2;
        });
        $(document).ready(function () {

            var ctx = document.getElementById("canvas").getContext("2d");
            window.myLine = new Chart(ctx, config);
            // Initialize();
        });


        // Where all the fun happens


        // Google has tweaked their interface somewhat - this tells the api to use that new UI
        google.maps.visualRefresh = true;
        var UAE = new google.maps.LatLng(25.204849, 55.270783);

        // These are options that set initial zoom level, where the map is centered globally to start, and the type of map to show
        var mapOptions = {
            zoom: 7,
            center: UAE,
            mapTypeId: google.maps.MapTypeId.G_NORMAL_MAP
        };

        // This makes the div with id "map_canvas" a google map
        var map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);

        // This shows adding a simple pin "marker" - United Arab Emirates!
        var myLatlng = new google.maps.LatLng(25.204849, 55.270783);

        var marker = new google.maps.Marker({
            position: myLatlng,
            map: map,
            title: 'United Arab Emirates'
        });

        // You can make markers different colors...  google it up!
        marker.setIcon('http://maps.google.com/mapfiles/ms/icons/green-dot.png')

        // a sample list of JSON encoded data of places to visit in United Arab Emirates
        // you can either make up a JSON list server side, or call it from a controller using JSONResult
        var data = [
                  { "Id": 1, "PlaceName": "Burj Khalifa", "OpeningHours": "7-10", "GeoLong": "25.2048", "GeoLat": "55.2708" },
                  { "Id": 2, "PlaceName": "Sheikh Sayad Mosque ", "OpeningHours": "7-4", "GeoLong": "24.2992", "GeoLat": "54.6973" },
                  { "Id": 3, "PlaceName": "Emirates Wheel", "OpeningHours": "9-7", "GeoLong": "25.3223", "GeoLat": "55.5136" },
                  { "Id": 4, "PlaceName": "Khor fakkan Beach", "OpeningHours": "8-12", "GeoLong": "25.4111", "GeoLat": "56.2482" },
                  { "Id": 5, "PlaceName": "Al Barsha", "OpeningHours": "10-10", "GeoLong": "25.0838", "GeoLat": "55.2204" }

        ];

        // Using the JQuery "each" selector to iterate through the JSON list and drop marker pins
        $.each(data, function (i, item) {
            var marker = new google.maps.Marker({
                'position': new google.maps.LatLng(item.GeoLong, item.GeoLat),
                'map': map,
                'title': item.PlaceName
            });

            // Make the marker-pin blue!
            marker.setIcon('http://maps.google.com/mapfiles/ms/icons/blue-dot.png')

            // put in some information about each json object - in this case, the opening hours.
            var infowindow = new google.maps.InfoWindow({
                content: "<div class='infoDiv'><h4>" + item.PlaceName + "</h4>" + "<div><h5>Opening hours: " + item.OpeningHours + "</h5></div></div>"
            });

            // finally hook up an "OnClick" listener to the map so it pops up out info-window when the marker-pin is clicked!
            google.maps.event.addListener(marker, 'click', function () {
                infowindow.open(map, marker);
            });

        })


    </script>*@
